$(document).ready(function(){function updateProgress(evt){if(evt.lengthComputable){var percentComplete=evt.loaded/evt.total;document.getElementById('progressBar').style.width=percentComplete+'%';$('#progressBar').html(percentage+'%');}else{document.getElementById('progressBar').style.width='100%';}}
function randomNumber(min,max){return Math.floor(Math.random()*(max-min+1)+min);};$('#captchaOperation').html([randomNumber(1,100),'+',randomNumber(1,200),'='].join(' '));$('#drvregister').bootstrapValidator({message:'This value is not valid',feedbackIcons:{valid:'glyphicon glyphicon-ok',invalid:'glyphicon glyphicon-remove',validating:'glyphicon glyphicon-refresh'},fields:{firstname:{group:'.form-group',validators:{notEmpty:{message:'The first name is required and cannot be empty'}}},lastname:{group:'.form-group',validators:{notEmpty:{message:'The last name is required and cannot be empty'}}},emailid:{validators:{notEmpty:{message:'The email address is required and can\'t be empty'},emailAddress:{message:'The input is not a valid email address'},remote:{type:'POST',url:'api/validate/email',message:'This Email-Id already  registered',delay:2000}}},dob:{validators:{notEmpty:{message:'The Date of Birth is required and can\'t be empty'},date:{format:'DD/MM/YYYY',message:'The Date of Birth is not valid'}}},gender:{validators:{notEmpty:{message:'The gender is required'}}},address:{group:'.form-group',validators:{notEmpty:{message:'Your address is required and cannot be empty'}}},vehiclenumber:{group:'.form-group',validators:{notEmpty:{message:'Your Vehicle Registration Number is required and cannot be empty'}}},licensenumber:{group:'.form-group',validators:{notEmpty:{message:'Your License Number is required and cannot be empty'}}},handset:{group:'.form-group',validators:{notEmpty:{message:'Your Handset Model is required and cannot be empty'}}},agree:{group:'.form-group',validators:{notEmpty:{message:'You have to agree the t&c'}}},captcha:{validators:{callback:{message:'Wrong answer',callback:function(value,validator){var items=$('#captchaOperation').html().split(' '),sum=parseInt(items[0])+parseInt(items[2]);return value==sum;}}}}}})
$('#drvregister').on('success.form.bv',function(e){e.preventDefault();$('#progress').modal({backdrop:'static',keyboard:false});$('#progress').modal('show');var $form=$(e.target);var bv=$form.data('bootstrapValidator');var formdata=new FormData(e.target);$.ajax({url:$form.attr('action'),type:'POST',data:formdata,async:false,xhr:function(){myXhr=$.ajaxSettings.xhr();if(myXhr.upload){myXhr.upload.addEventListener('progress',updateProgress,false);}
return myXhr;},success:function(xml){var message=$(xml).find('message').text();$('#returnmsg').html(message);$('#progress').modal('hide');$('#message').modal('show');},error:function(jqXHR,textStatus,errorThrown){$('#progress').modal('hide');$('#returnmsg').html('<p>Error Submitting Form</p><p>'+textStatus+'</p><p>'+errorThrown+'</p>');$('#message').modal('show');},cache:false,contentType:false,processData:false});});});